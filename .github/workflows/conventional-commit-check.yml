name: Semantic Commit Check

on:
  pull_request:
    types:
      - opened
      - reopened
      - edited
      - synchronize

permissions:
  contents: read

jobs:
  semantic-pr:
    concurrency:
      group: ${{ github.workflow }}-semantic-commit-check-${{ github.event.pull_request.number }}
      cancel-in-progress: true
    name: Validate PR Title
    runs-on: ubuntu-latest
    steps:
      - uses: amannn/action-semantic-pull-request@2d952a1bf90a6a7ab8f0293dc86f5fdf9acb1915 # v5.5.3
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          types: |
            feat
            fix
            docs
            refactor
            perf
            test
            build
            ci
            chore
            revert
            misc
          requireScope: false
          scopes: |
            parser
            analyzer
            planner
            spi
            scheduler
            protocol
            connector
            resource
            security
            function
            type
            expression
            operator
            client
            server
            native
            native-pos
            testing
            docs
            build
            ci
            ui
            plugin-[a-zA-Z][a-zA-Z0-9-]*
          subjectPattern: ^[A-Z].*[^.]$
          subjectPatternError: |
            The PR title subject must start with a capital letter and not end with a period.
